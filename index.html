<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GESTACRISES - Agent Orchestrateur</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8fafc;
            overflow-x: hidden;
        }

        .header {
            padding: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .header h1 {
            font-size: 38px;
            margin-bottom: 12px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 18px;
            opacity: 0.95;
            margin-bottom: 8px;
        }

        .workflow-container {
            padding: 40px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .orchestrator-card {
            background: white;
            padding: 40px;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.12);
            border: 4px solid #8b5cf6;
            background: linear-gradient(to right, #f3e8ff 0%, white 10%);
        }

        .orchestrator-header {
            display: flex;
            align-items: flex-start;
            gap: 20px;
            margin-bottom: 25px;
            padding-bottom: 25px;
            border-bottom: 3px solid #8b5cf6;
        }

        .orchestrator-icon {
            font-size: 60px;
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #8b5cf6, #6d28d9);
            border-radius: 16px;
            flex-shrink: 0;
        }

        .orchestrator-title-block {
            flex: 1;
        }

        .orchestrator-name {
            font-size: 32px;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 10px;
        }

        .orchestrator-subtitle {
            font-size: 18px;
            color: #6b7280;
            line-height: 1.6;
        }

        .orchestrator-badge {
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 700;
            text-transform: uppercase;
            background: #faf5ff;
            color: #8b5cf6;
            border: 2px solid #8b5cf6;
            display: inline-block;
        }

        .orchestrator-content {
            color: #4b5563;
            line-height: 1.9;
            font-size: 16px;
            margin: 25px 0;
        }

        .orchestrator-content ul {
            margin: 15px 0;
            padding-left: 30px;
        }

        .orchestrator-content li {
            margin: 12px 0;
        }

        .highlight-box {
            margin: 25px 0;
            padding: 25px;
            background: #faf5ff;
            border-left: 6px solid #8b5cf6;
            border-radius: 10px;
        }

        .highlight-box strong {
            color: #6d28d9;
            font-size: 17px;
            display: block;
            margin-bottom: 12px;
        }

        .phase-section {
            margin: 30px 0;
            padding: 25px;
            background: linear-gradient(to right, #f8fafc 0%, white 50%);
            border-radius: 12px;
            border-left: 5px solid #cbd5e1;
        }

        .phase-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .phase1 { border-left-color: #3b82f6; }
        .phase2 { border-left-color: #f59e0b; }
        .phase3 { border-left-color: #10b981; }
        .phase-loop { border-left-color: #8b5cf6; }
        .phase-retex { border-left-color: #6366f1; }

        .agents-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .agent-item {
            padding: 15px;
            background: white;
            border-radius: 8px;
            border: 2px solid #e5e7eb;
            font-size: 14px;
            font-weight: 600;
            color: #475569;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }

        .agent-item:hover {
            border-color: #8b5cf6;
            background: #faf5ff;
            transform: translateX(5px);
            box-shadow: 0 2px 8px rgba(139, 92, 246, 0.2);
        }

        .agent-item.validation {
            border-color: #f59e0b;
            background: #fffbeb;
        }

        .agent-item.validation:hover {
            border-color: #f59e0b;
            background: #fef3c7;
        }

        .agent-item.critical {
            border-color: #dc2626;
            background: #fee2e2;
        }

        .agent-item.critical:hover {
            border-color: #dc2626;
            background: #fecaca;
        }

        .agent-icon-small {
            font-size: 24px;
        }

        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }

        .stat-box {
            text-align: center;
            padding: 25px;
            border-radius: 12px;
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border-top: 4px solid #8b5cf6;
        }

        .stat-value {
            font-size: 48px;
            font-weight: bold;
            color: #8b5cf6;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #64748b;
            font-size: 14px;
            font-weight: 600;
        }

        /* MODAL STYLES */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 9999;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.2s;
        }

        .modal-overlay.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-box {
            background: white;
            border-radius: 12px;
            padding: 35px;
            max-width: 700px;
            width: 90%;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            position: relative;
            animation: slideUp 0.3s;
        }

        @keyframes slideUp {
            from { 
                opacity: 0;
                transform: translateY(30px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 36px;
            height: 36px;
            border: none;
            background: #f3f4f6;
            border-radius: 8px;
            cursor: pointer;
            font-size: 24px;
            color: #6b7280;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .modal-close:hover {
            background: #e5e7eb;
            color: #dc2626;
        }

        .modal-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e5e7eb;
        }

        .modal-icon {
            font-size: 42px;
            width: 65px;
            height: 65px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #8b5cf6, #6d28d9);
            border-radius: 12px;
            flex-shrink: 0;
        }

        .modal-title {
            font-size: 22px;
            font-weight: 700;
            color: #1f2937;
            padding-right: 30px;
        }

        .modal-section {
            margin: 20px 0;
        }

        .modal-section-title {
            font-weight: 700;
            color: #8b5cf6;
            margin-bottom: 12px;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .modal-content {
            color: #4b5563;
            line-height: 1.8;
            font-size: 15px;
        }

        .modal-content ul {
            margin: 12px 0;
            padding-left: 25px;
        }

        .modal-content li {
            margin: 10px 0;
        }

        .modal-highlight {
            background: #faf5ff;
            padding: 18px;
            border-radius: 8px;
            border-left: 4px solid #8b5cf6;
            margin: 15px 0;
        }

        .modal-functions {
            background: #f8fafc;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .modal-function-tag {
            display: inline-block;
            padding: 6px 12px;
            background: white;
            border: 1.5px solid #cbd5e1;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            color: #475569;
            margin: 4px 4px 4px 0;
            font-family: 'Courier New', monospace;
        }

        .modal-validation-options {
            background: #fffbeb;
            padding: 18px;
            border-radius: 8px;
            border: 2px solid #fbbf24;
            margin: 15px 0;
        }

        .modal-validation-option {
            padding: 12px;
            margin: 8px 0;
            background: white;
            border-radius: 6px;
            border-left: 3px solid #f59e0b;
        }

        @media (max-width: 768px) {
            .orchestrator-header {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }
            
            .modal-box {
                width: 95%;
                padding: 25px;
                max-height: 90vh;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üéØ GESTACRISES - Agent Orchestrateur</h1>
        <p>Le Cerveau Central qui Coordonne les 15 Agents Sp√©cialis√©s</p>
    </div>

    <div class="workflow-container">
        
        <div class="orchestrator-card">
            <div class="orchestrator-header">
                <div class="orchestrator-icon">üéØ</div>
                <div class="orchestrator-title-block">
                    <div class="orchestrator-name">AGENT ORCHESTRATEUR</div>
                    <div class="orchestrator-subtitle">Chef d'Orchestre du Workflow GESTACRISES</div>
                </div>
                <div class="orchestrator-badge">MISTRAL LARGE</div>
            </div>

            <div class="orchestrator-content">
                <strong style="font-size: 18px; color: #1f2937;">Mission Centrale :</strong>
                <p style="margin: 15px 0;">
                    Gestion intelligente et automatique du workflow complet de gestion de crise selon la m√©thodologie 
                    <strong>COMPRENDRE ‚Üí D√âCIDER ‚Üí DIRIGER ‚Üí RETEX</strong> + Boucle Continue de pilotage.
                </p>
            </div>

            <div class="highlight-box">
                <strong>üéØ Principe de Fonctionnement :</strong>
                L'Orchestrateur est le cerveau central qui d√©cide automatiquement quel agent appeler, dans quel ordre, 
                et avec quels param√®tres, en fonction de la situation de crise et de son √©volution. Les 15 agents 
                sp√©cialis√©s sont ses "outils" (tools/functions) qu'il active selon les besoins.
            </div>

            <div class="orchestrator-content">
                <strong style="font-size: 18px; color: #1f2937;">Responsabilit√©s Cl√©s :</strong>
                <ul>
                    <li><strong>S√©quencement intelligent :</strong> Appelle les agents dans l'ordre optimal selon la phase de crise</li>
                    <li><strong>Collecte et transmission :</strong> R√©cup√®re les r√©sultats d'un agent et les transmet au suivant</li>
                    <li><strong>Gestion des validations :</strong> Pause le workflow et attend la validation humaine quand n√©cessaire</li>
                    <li><strong>Adaptation dynamique :</strong> Modifie l'ordre ou saute des √©tapes selon le contexte</li>
                    <li><strong>Coordination parall√®le :</strong> Active plusieurs agents simultan√©ment quand opportun (Phase DIRIGER)</li>
                    <li><strong>Boucle √©v√©nementielle :</strong> G√®re le flux continu √©v√©nements ‚Üí classification ‚Üí r√©√©valuation</li>
                </ul>
            </div>

            <!-- PHASE 1 -->
            <div class="phase-section phase1">
                <div class="phase-title">üìä PHASE 1 : COMPRENDRE</div>
                <p style="color: #64748b; margin-bottom: 15px;">Appelle s√©quentiellement avec validations interm√©diaires :</p>
                <div class="agents-grid">
                    <div class="agent-item" data-agent="agent1">
                        <span class="agent-icon-small">ü§ñ</span>
                        Agent 1 ‚Üí Extracteur PCS
                    </div>
                    <div class="agent-item" data-agent="agent2">
                        <span class="agent-icon-small">ü§ñ</span>
                        Agent 2 ‚Üí Analyseur MEDO
                    </div>
                    <div class="agent-item validation" data-agent="validation1">
                        <span class="agent-icon-small">‚úã</span>
                        Validation 1 ‚Üí Analyse
                    </div>
                    <div class="agent-item" data-agent="agent3">
                        <span class="agent-icon-small">ü§ñ</span>
                        Agent 3 ‚Üí Analyseur Mission
                    </div>
                    <div class="agent-item validation" data-agent="validation2">
                        <span class="agent-icon-small">‚úã</span>
                        Validation 2 ‚Üí Mission
                    </div>
                    <div class="agent-item" data-agent="agent4">
                        <span class="agent-icon-small">ü§ñ</span>
                        Agent 4 ‚Üí Besoins vs Moyens
                    </div>
                    <div class="agent-item validation" data-agent="validation3">
                        <span class="agent-icon-small">‚úã</span>
                        Validation 3 ‚Üí √âcarts
                    </div>
                    <div class="agent-item" data-agent="agent5">
                        <span class="agent-icon-small">ü§ñ</span>
                        Agent 5 ‚Üí Effet Majeur
                    </div>
                    <div class="agent-item validation" data-agent="validation4">
                        <span class="agent-icon-small">‚úã</span>
                        Validation 4 ‚Üí Effet Majeur
                    </div>
                </div>
            </div>

            <!-- PHASE 2 -->
            <div class="phase-section phase2">
                <div class="phase-title">üéØ PHASE 2 : D√âCIDER</div>
                <p style="color: #64748b; margin-bottom: 15px;">Appelle avec validation critique du Mode d'Action :</p>
                <div class="agents-grid">
                    <div class="agent-item" data-agent="agent6">
                        <span class="agent-icon-small">ü§ñ</span>
                        Agent 6 ‚Üí Modes d'Action
                    </div>
                    <div class="agent-item critical" data-agent="validation5">
                        <span class="agent-icon-small">‚ö†Ô∏è</span>
                        Validation 5 ‚Üí CRITIQUE
                    </div>
                    <div class="agent-item" data-agent="agent7">
                        <span class="agent-icon-small">ü§ñ</span>
                        Agent 7 ‚Üí Reformulateur
                    </div>
                    <div class="agent-item validation" data-agent="validation6">
                        <span class="agent-icon-small">‚úã</span>
                        Validation 6 ‚Üí MA D√©finitif
                    </div>
                </div>
            </div>

            <!-- PHASE 3 -->
            <div class="phase-section phase3">
                <div class="phase-title">üöÄ PHASE 3 : DIRIGER</div>
                <p style="color: #64748b; margin-bottom: 15px;">Appelle en parall√®le pour op√©rationnalisation :</p>
                <div class="agents-grid">
                    <div class="agent-item" data-agent="agent8">
                        <span class="agent-icon-small">ü§ñ</span>
                        Agent 8 ‚Üí Ordres/Consignes
                    </div>
                    <div class="agent-item" data-agent="agent9">
                        <span class="agent-icon-small">ü§ñ</span>
                        Agent 9 ‚Üí Communication
                    </div>
                    <div class="agent-item" data-agent="agent10">
                        <span class="agent-icon-small">ü§ñ</span>
                        Agent 10 ‚Üí Pilotage
                    </div>
                </div>
            </div>

            <!-- BOUCLE -->
            <div class="phase-section phase-loop">
                <div class="phase-title">üîÑ BOUCLE CONTINUE</div>
                <p style="color: #64748b; margin-bottom: 15px;">G√®re le cycle √©v√©nementiel permanent :</p>
                <div class="agents-grid">
                    <div class="agent-item" data-agent="agent11">
                        <span class="agent-icon-small">üåê</span>
                        Agent 11 ‚Üí Veilleur Web (dans un second temps)
                    </div>
                    <div class="agent-item" data-agent="flux-humain">
                        <span class="agent-icon-small">üì•</span>
                        √âv√©nements terrain
                    </div>
                    <div class="agent-item" data-agent="agent12">
                        <span class="agent-icon-small">ü§ñ</span>
                        Agent 12 ‚Üí Trieur
                    </div>
                    <div class="agent-item critical" data-agent="decision-critique">
                        <span class="agent-icon-small">üîÄ</span>
                        Si CRITIQUE ‚Üí
                    </div>
                    <div class="agent-item" data-agent="agent13">
                        <span class="agent-icon-small">ü§ñ</span>
                        Agent 13 ‚Üí R√©√©valuateur
                    </div>
                    <div class="agent-item validation" data-agent="validation-event">
                        <span class="agent-icon-small">‚úã</span>
                        Validation √âv√©nement
                    </div>
                </div>
                <p style="text-align: center; margin-top: 20px; color: #6d28d9; font-weight: bold; font-size: 16px;">
                    ‚Üª Retour au d√©but de la boucle - Cycle infini
                </p>
            </div>

            <!-- RESTITUTION -->
            <div class="highlight-box" style="background: #f0f9ff; border-left-color: #3b82f6;">
                <strong>üìã Agent Transverse :</strong>
                <div class="agent-item" style="margin-top: 12px;" data-agent="agent14">
                    <span class="agent-icon-small">üìÑ</span>
                    Agent 14 ‚Üí G√©n√©rateur Documents (appel√© √† la demande √† tout moment)
                </div>
            </div>

            <!-- FIN DE CRISE - RETEX -->
            <div class="phase-section phase-retex">
                <div class="phase-title">üéì FIN DE CRISE - RETEX</div>
                <p style="color: #64748b; margin-bottom: 15px;">Analyse compl√®te post-crise :</p>
                <div class="agents-grid">
                    <div class="agent-item" data-agent="agent15">
                        <span class="agent-icon-small">üìä</span>
                        Agent 15 ‚Üí G√©n√©rateur RETEX
                    </div>
                </div>
            </div>

        </div>

        <!-- STATISTIQUES -->
        <div class="summary-stats">
            <div class="stat-box">
                <div class="stat-value">1</div>
                <div class="stat-label">Orchestrateur Central</div>
            </div>
            <div class="stat-box">
                <div class="stat-value">15</div>
                <div class="stat-label">Agents Outils</div>
            </div>
            <div class="stat-box">
                <div class="stat-value">3</div>
                <div class="stat-label">Phases Principales</div>
            </div>
            <div class="stat-box">
                <div class="stat-value">6</div>
                <div class="stat-label">Points de Validation</div>
            </div>
            <div class="stat-box">
                <div class="stat-value">‚àû</div>
                <div class="stat-label">Boucle Continue</div>
            </div>
            <div class="stat-box">
                <div class="stat-value">1</div>
                <div class="stat-label">RETEX Final</div>
            </div>
        </div>

    </div>

    <!-- MODAL POPUP -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal-box">
            <button class="modal-close" onclick="closeModal()">√ó</button>
            <div id="modalContent"></div>
        </div>
    </div>

    <script>
        const agentsData = {
            'agent1': {
                icon: 'ü§ñ',
                title: 'Agent 1 : Extracteur PCS',
                model: 'MISTRAL LARGE',
                mission: 'Analyser le PCS et extraire toutes les informations pertinentes selon le type de crise',
                actions: [
                    'Identification des acteurs cl√©s (maire, pr√©fet, services municipaux, associations)',
                    'Extraction des moyens disponibles (humains, mat√©riels, infrastructures)',
                    'Cartographie des zones √† risque selon le type de crise d√©clar√©',
                    'Extraction des proc√©dures d\'alerte et protocoles d\'activation',
                    'Identification des populations vuln√©rables prioritaires'
                ],
                functions: ['lire_pcs', 'sauvegarder_etat', 'ecrire_main_courante'],
                output: 'Donn√©es PCS structur√©es en JSON ‚Üí Transmises aux agents suivants (Prompt caching activ√©)'
            },
            'agent2': {
                icon: 'ü§ñ',
                title: 'Agent 2 : Analyseur Situation (MEDO)',
                model: 'MISTRAL LARGE',
                mission: 'Analyse approfondie selon la matrice MEDO (4 dimensions)',
                actions: [
                    '<strong>MISSION :</strong> De quoi s\'agit-il ? Qu\'attend-on du PCC ? Quelles composantes ?',
                    '<strong>ENVIRONNEMENT :</strong> Contexte g√©n√©ral, contraintes r√©glementaires, opportunit√©s',
                    '<strong>SITUATION :</strong> Acteurs impliqu√©s, risques identifi√©s, d√©lais critiques',
                    '<strong>BESOINS & MOYENS :</strong> Ressources n√©cessaires vs disponibles, √©carts √† combler'
                ],
                functions: ['lire_contexte', 'sauvegarder_etat', 'ecrire_main_courante'],
                output: 'Conclusions de l\'analyse de situation (synth√®se matricielle MEDO)'
            },
            'agent3': {
                icon: 'ü§ñ',
                title: 'Agent 3 : Analyseur Mission',
                model: 'MISTRAL LARGE',
                mission: 'D√©finition pr√©cise et exhaustive de la mission du PCC',
                actions: [
                    '<strong>De quoi s\'agit-il ? Quoi ?</strong> Nature exacte de la mission',
                    '<strong>Pourquoi ? Qu\'attend-on de moi ?</strong> Finalit√© et attentes',
                    '<strong>Quelles sont les composantes de la r√©alisation ?</strong>',
                    '<strong>Quelles sont les t√¢ches √† r√©aliser ?</strong> Actions concr√®tes',
                    '<strong>Quelle est ma libert√© d\'action ?</strong> Contraintes et marges'
                ],
                functions: ['lire_contexte', 'sauvegarder_etat', 'ecrire_main_courante'],
                output: 'Synth√®se de la mission du PCC uniquement (format concis et structur√©)'
            },
            'agent4': {
                icon: 'ü§ñ',
                title: 'Agent 4 : Confrontation Besoins vs Moyens',
                model: 'MISTRAL LARGE',
                mission: 'Analyse comparative et identification des √©carts critiques',
                actions: [
                    '<strong>Bilan des forces et faiblesses</strong> de l\'organisation municipale',
                    '<strong>√âvaluation des capacit√©s</strong> des diff√©rents acteurs mobilisables',
                    '<strong>√âvaluation des besoins</strong> en regard des moyens r√©ellement disponibles',
                    '<strong>Balance des potentiels</strong> (forces mobilisables vs n√©cessaires)',
                    '<strong>Besoins en renforts</strong> (humains, mat√©riels, techniques)',
                    '<strong>Besoins en informations</strong> (donn√©es manquantes critiques)'
                ],
                functions: ['lire_contexte', 'sauvegarder_etat', 'ecrire_main_courante'],
                output: 'Conclusions uniquement (synth√®se comparative Besoins vs Moyens)'
            },
            'agent5': {
                icon: 'ü§ñ',
                title: 'Agent 5 : D√©terminateur Effet Majeur',
                model: 'MISTRAL LARGE',
                mission: 'Identification de l\'objectif strat√©gique principal conditionnant le succ√®s',
                highlight: 'üìå <strong>D√©finition Effet Majeur :</strong><br><em>"Ce qui conditionne le succ√®s de la mission et sur lequel on va b√¢tir toute notre action"</em>',
                actions: [
                    'L\'agent propose l\'effet majeur qui servira de fondation strat√©gique √† toutes les d√©cisions et actions futures',
                    'Cet effet majeur doit √™tre clair, mesurable et atteignable',
                    'Il conditionne toute la suite du workflow'
                ],
                functions: ['lire_contexte', 'sauvegarder_etat', 'ecrire_main_courante'],
                output: 'Proposition d\'effet majeur argument√© et justifi√© par l\'analyse'
            },
            'agent6': {
                icon: 'ü§ñ',
                title: 'Agent 6 : Comparateur Modes d\'Action',
                model: 'MISTRAL LARGE',
                mission: 'G√©n√©ration et analyse comparative multi-sc√©narios',
                actions: [
                    '<strong>Pour chaque MA :</strong> Objectifs interm√©diaires, Contraintes op√©rationnelles, Risques identifi√©s',
                    '<strong>Analyse comparative :</strong> Les + (avantages), Les - (inconv√©nients)',
                    '<strong>Quantificateurs :</strong> Scores de faisabilit√©, notations, probabilit√©s de succ√®s',
                    '<strong>Crit√®res de choix :</strong> R√©alisation de l\'effet majeur + Respect des objectifs interm√©diaires',
                    'G√©n√©ration de 2-3 Modes d\'Action possibles'
                ],
                functions: ['lire_contexte', 'sauvegarder_etat', 'ecrire_main_courante'],
                output: 'Tableau comparatif des Modes d\'Action avec quantificateurs + Balance et synth√®se argument√©e'
            },
            'agent7': {
                icon: 'ü§ñ',
                title: 'Agent 7 : Reformulateur Mode d\'Action',
                model: 'MISTRAL LARGE',
                mission: 'Formalisation du Mode d\'Action d√©finitif apr√®s validation',
                actions: [
                    'Reformule le MA en tenant compte du choix valid√© par l\'utilisateur (VALIDER / MIXER / AMENDER)',
                    'Int√®gre les √©ventuels m√©langes de modes d\'action si option MIXER s√©lectionn√©e',
                    'Int√®gre les amendements sp√©cifiques demand√©s si option AMENDER choisie',
                    'V√©rifie la coh√©rence globale avec l\'effet majeur valid√©'
                ],
                functions: ['lire_contexte', 'sauvegarder_etat', 'ecrire_main_courante'],
                output: 'Mode d\'action d√©finitif reformul√©, structur√© et op√©rationnel'
            },
            'agent8': {
                icon: 'ü§ñ',
                title: 'Agent 8 : G√©n√©rateur Ordres/Consignes',
                model: 'MISTRAL LARGE',
                mission: 'Transmission structur√©e aux cellules du PCC',
                highlight: 'üìã <strong>Cadre de communication impos√© :</strong><br><br><strong>Votre mission :</strong> [Rappel succinct]<br><strong>L\'objectif est de :</strong> [Effet majeur retenu]<br><strong>Pour ce faire :</strong> [D√©clinaison du mode d\'action choisi]<br><strong>Votre action :</strong> [D√©tails op√©rationnels]',
                actions: [
                    'Cadre espace-temps d√©fini pr√©cis√©ment',
                    'Moyens dont chaque cellule dispose',
                    'Liste exhaustive des actions et leur ex√©cution (la plus d√©taill√©e possible)',
                    'Objectifs interm√©diaires avec √©ch√©ances',
                    'Indicateurs de r√©ussite mesurables'
                ],
                functions: ['lire_contexte', 'generer_document', 'ecrire_main_courante'],
                output: 'Fiches de mission d√©taill√©es par cellule du PCC (ordres & consignes op√©rationnels)'
            },
            'agent9': {
                icon: 'ü§ñ',
                title: 'Agent 9 : G√©n√©rateur Communication',
                model: 'MISTRAL LARGE',
                mission: 'Plan de communication complet multi-publics',
                actions: [
                    'üèõÔ∏è <strong>Autorit√©s</strong> (Pr√©fecture, services de l\'√âtat, forces de l\'ordre)',
                    'üë• <strong>√âlus</strong> (Conseil municipal, √©lus d√©partementaux et r√©gionaux)',
                    'üëî <strong>Agents</strong> (Services municipaux, agents du PCC, partenaires)',
                    'üèòÔ∏è <strong>Population</strong> (Citoyens, entreprises, associations, m√©dias)',
                    '<br><strong>Pour chaque public :</strong> Messages adapt√©s, canaux de diffusion, fr√©quence et responsable'
                ],
                highlight: '‚ö†Ô∏è <strong>IMPORTANT :</strong> L\'agent g√©n√®re le <strong>CONTENU</strong> des messages. Les humains copient/collent et envoient manuellement via leurs outils (email, t√©l√©phone, etc.)',
                functions: ['lire_contexte', 'generer_document', 'envoyer_notification', 'ecrire_main_courante'],
                output: 'Plan de communication complet (messages, canaux, fr√©quences et responsables par public cible)'
            },
            'agent10': {
                icon: 'ü§ñ',
                title: 'Agent 10 : Configurateur Pilotage',
                model: 'MISTRAL LARGE',
                mission: 'Configuration du syst√®me de pilotage continu de la crise',
                actions: [
                    '<strong>Points de situation r√©guliers :</strong> Fr√©quence adapt√©e, format standardis√©, indicateurs de suivi',
                    '<strong>Main-courante op√©rationnelle :</strong> Structure d\'enregistrement chronologique des √©v√©nements humains',
                    '<strong>Journal IA :</strong> Structure d\'enregistrement des propositions IA + validations humaines',
                    '<strong>Sites de veille (dans un second temps) :</strong> Configuration selon type de crise (M√©t√©o France, Vigicrues, etc.)',
                    '<strong>Proc√©dure de r√©activation :</strong> Protocole de relance du workflow si changement majeur',
                    '<strong>Tableaux de bord :</strong> Indicateurs cl√©s temps r√©el pour chaque cellule'
                ],
                functions: ['lire_contexte', 'sauvegarder_etat', 'ecrire_main_courante'],
                output: 'Configuration compl√®te : Tableau de bord + Main-courante + Sites de veille + Proc√©dure r√©activation'
            },
            'agent11': {
                icon: 'üåê',
                title: 'Agent 11 : Veilleur Web Automatique',
                model: 'MISTRAL SMALL + WEB SEARCH',
                subtitle: '‚ö†Ô∏è Fonctionnalit√© disponible dans un second temps',
                mission: 'Surveillance continue selon le type de crise d√©clar√©',
                actions: [
                    'üåä <strong>Submersion marine :</strong> Vigicrues, M√©t√©o France (mar√©es, coefficients), vigilance c√¥ti√®re',
                    'üî• <strong>Incendie :</strong> M√©t√©o France (vents, temp√©rature, hygrom√©trie), qualit√© de l\'air, alertes pr√©fecture',
                    'üå°Ô∏è <strong>Canicule :</strong> Temp√©ratures temps r√©el et pr√©visions, plan canicule national, alertes sanitaires',
                    'üí• <strong>Accident industriel :</strong> Qualit√© de l\'air (polluants), bulletins pr√©fecture, consignes confinement',
                    '‚ùÑÔ∏è <strong>Temp√™te/Neige :</strong> Alertes m√©t√©o orange/rouge, √©tat des routes, coupures √©lectriques Enedis',
                    '<br>‚è±Ô∏è <strong>Polling intelligent :</strong> Fr√©quence adapt√©e aux horaires critiques (ex: 11h, 14h, 17h pour canicule)'
                ],
                functions: ['web_search', 'ecrire_main_courante', 'envoyer_notification'],
                output: '√âv√©nements d√©tect√©s automatiquement avec niveau de criticit√© √©valu√©'
            },
            'agent12': {
                icon: 'ü§ñ',
                title: 'Agent 12 : Trieur d\'√âv√©nements',
                model: 'MISTRAL SMALL',
                mission: 'Classification rapide et efficace de tous les √©v√©nements',
                actions: [
                    'Analyse rapide du contenu de l\'√©v√©nement (~500 tokens)',
                    'Classification binaire : <strong>CRITIQUE</strong> ou <strong>PAS CRITIQUE</strong>',
                    'Extraction des informations structur√©es (qui, quoi, o√π, quand)',
                    '√âvaluation de l\'impact potentiel sur la strat√©gie actuelle',
                    'Traite les √©v√©nements humains (Phase 1) + automatiques web (√† venir)'
                ],
                functions: ['lire_contexte', 'ecrire_main_courante'],
                output: 'Classification (CRITIQUE/PAS CRITIQUE) + √âv√©nement structur√© JSON'
            },
            'agent13': {
                icon: 'ü§ñ',
                title: 'Agent 13 : R√©√©valuateur Rapide',
                model: 'MISTRAL LARGE',
                mission: 'Mini-cycle d√©cisionnel si √©v√©nement critique d√©tect√©',
                highlight: '‚ö° <strong>Principe de r√©activit√© :</strong><br><em>Nouvelle situation ‚áí nouvelles d√©cisions ‚áí nouvelles consignes ‚áí nouvelles communications</em>',
                actions: [
                    'Analyse de l\'impact de l\'√©v√©nement sur la situation actuelle',
                    '√âvaluation si changement d\'effet majeur ou de mode d\'action n√©cessaire',
                    '<strong>Si impact majeur :</strong> Proposition de nouvelles d√©cisions strat√©giques',
                    '<strong>Si impact mineur :</strong> Ajustements tactiques uniquement (pas de changement strat√©gique)',
                    'G√©n√©ration de nouvelles consignes adapt√©es si n√©cessaire',
                    'Mise √† jour du plan de communication si besoin'
                ],
                functions: ['lire_contexte', 'rechercher_evenements', 'web_search', 'envoyer_notification', 'ecrire_main_courante'],
                output: 'Analyse d\'impact d√©taill√©e + Propositions de nouvelles d√©cisions + Nouvelles consignes/communications + Mises √† jour tableaux de bord'
            },
            'agent14': {
                icon: 'üìÑ',
                title: 'Agent 14 : G√©n√©rateur Documents',
                model: 'MISTRAL SMALL',
                mission: 'G√©n√©ration de documents format√©s √† la demande (pas seulement en fin de crise)',
                actions: [
                    'üìÑ <strong>Formats disponibles :</strong> PDF, Word (DOCX), Email, JSON, TXT',
                    'üìä <strong>Types de documents :</strong> Fiches de mission, rapports de situation, communiqu√©s, synth√®ses',
                    '‚è±Ô∏è <strong>D√©clenchement :</strong> √Ä la demande √† tout moment (pas uniquement en fin de crise)',
                    'üìß <strong>Diffusion automatique :</strong> Envoi par email aux destinataires si demand√©',
                    'üîÑ <strong>Mise √† jour dynamique :</strong> Documents actualis√©s en temps r√©el avec derni√®res donn√©es',
                    '<strong>Sources :</strong> Main-courante humaine + Journal IA'
                ],
                functions: ['lire_contexte', 'generer_document'],
                output: 'Documents format√©s pr√™ts √† diffuser (PDF, DOCX, Email, etc.) avec donn√©es temps r√©el'
            },
            'agent15': {
                icon: 'üìä',
                title: 'Agent 15 : G√©n√©rateur RETEX',
                model: 'MISTRAL LARGE',
                subtitle: 'Retour d\'Exp√©rience - Analyse compl√®te post-crise',
                mission: 'Analyse exhaustive de la gestion de crise pour am√©lioration continue',
                actions: [
                    '<strong>Points positifs :</strong> Ce qui a bien fonctionn√© pendant la crise',
                    '<strong>Points d\'am√©lioration :</strong> Ce qui doit √™tre am√©lior√© pour les prochaines fois',
                    '<strong>Dysfonctionnements identifi√©s :</strong> Probl√®mes rencontr√©s et leurs causes',
                    '<strong>Propositions d\'amendements du PCS :</strong> Modifications √† apporter au plan',
                    '<strong>Recommandations op√©rationnelles :</strong> Conseils pratiques pour futures crises',
                    '<strong>Le√ßons apprises :</strong> Synth√®se des enseignements tir√©s',
                    '<br><strong>üìö Sources analys√©es :</strong>',
                    '‚Ä¢ Main-courante op√©rationnelle (tous les √©v√©nements humains enregistr√©s)',
                    '‚Ä¢ Journal IA (toutes les propositions IA + validations humaines)',
                    '‚Ä¢ T√©moignages des acteurs impliqu√©s dans la gestion'
                ],
                functions: ['lire_contexte', 'rechercher_evenements', 'generer_document'],
                output: 'Rapport RETEX structur√© (format DOCX/PDF) + Liste d\'amendements PCS propos√©s'
            },
            'validation1': {
                icon: '‚úã',
                title: 'VALIDATION 1 - Analyse de Situation',
                subtitle: 'Premier point de contr√¥le humain - V√©rification analyse MEDO',
                validation: true,
                options: [
                    '<strong>1Ô∏è‚É£ VALIDER</strong> - Confirmer l\'analyse et passer √† l\'√©tape suivante',
                    '<strong>2Ô∏è‚É£ AMENDER</strong> - Corriger ou compl√©ter les conclusions avant de continuer'
                ]
            },
            'validation2': {
                icon: '‚úã',
                title: 'VALIDATION 2 - Mission du PCC',
                subtitle: 'Validation de la synth√®se mission avant analyse moyens',
                validation: true,
                options: [
                    '<strong>1Ô∏è‚É£ VALIDER</strong> - Confirmer la mission et continuer l\'analyse',
                    '<strong>2Ô∏è‚É£ AMENDER</strong> - Ajuster la formulation de la mission'
                ]
            },
            'validation3': {
                icon: '‚úã',
                title: 'VALIDATION 3 - Besoins vs Moyens',
                subtitle: 'Validation de l\'analyse comparative et des √©carts',
                validation: true,
                options: [
                    '<strong>1Ô∏è‚É£ VALIDER</strong> - Confirmer l\'analyse des √©carts',
                    '<strong>2Ô∏è‚É£ AMENDER</strong> - Ajuster les conclusions de l\'analyse'
                ]
            },
            'validation4': {
                icon: '‚úã',
                title: 'VALIDATION 4 - Effet Majeur',
                subtitle: 'Validation de l\'objectif strat√©gique principal',
                validation: true,
                options: [
                    '<strong>1Ô∏è‚É£ VALIDER</strong> - Confirmer l\'effet majeur propos√©',
                    '<strong>2Ô∏è‚É£ AMENDER</strong> - Reformuler l\'effet majeur'
                ]
            },
            'validation5': {
                icon: '‚ö†Ô∏è',
                title: 'VALIDATION 5 - Choix du Mode d\'Action',
                subtitle: '‚ö° POINT DE D√âCISION STRAT√âGIQUE MAJEURE ‚ö°',
                validation: true,
                critical: true,
                highlight: 'Point de d√©cision strat√©gique d√©terminant pour toute la suite des op√©rations',
                options: [
                    '<strong>1Ô∏è‚É£ VALIDER</strong> - Choisir un mode d\'action tel quel',
                    '<strong>2Ô∏è‚É£ MIXER</strong> - Combiner 2 modes d\'action compl√©mentaires',
                    '<strong>3Ô∏è‚É£ AMENDER</strong> - Modifier un mode d\'action avant validation'
                ]
            },
            'validation6': {
                icon: '‚úã',
                title: 'VALIDATION 6 - Mode d\'Action D√©finitif',
                subtitle: 'Validation finale avant passage √† la phase DIRIGER',
                validation: true,
                options: [
                    '<strong>1Ô∏è‚É£ VALIDER</strong> - Passer √† la phase DIRIGER avec ce MA',
                    '<strong>2Ô∏è‚É£ AMENDER</strong> - Ajuster une derni√®re fois la reformulation'
                ]
            },
            'validation-event': {
                icon: '‚úã',
                title: 'VALIDATION √âV√âNEMENT - Nouvelles D√©cisions',
                subtitle: 'Validation des propositions de l\'Agent R√©√©valuateur',
                validation: true,
                options: [
                    '<strong>1Ô∏è‚É£ VALIDER</strong> - Appliquer les nouvelles d√©cisions propos√©es',
                    '<strong>2Ô∏è‚É£ AMENDER</strong> - Ajuster les propositions avant application',
                    '<strong>3Ô∏è‚É£ REFUSER</strong> - Conserver la strat√©gie actuelle (√©v√©nement pas assez critique)'
                ],
                highlight: '<strong>Tra√ßabilit√© :</strong><br>‚Ä¢ IA : enregistrer_action_ia() ‚Üí Propositions + validation humaine<br>‚Ä¢ Si validation : ecrire_main_courante() ‚Üí D√©cision appliqu√©e'
            },
            'flux-humain': {
                icon: 'üì•',
                title: 'FLUX A : √âv√©nements Humains',
                subtitle: 'Phase 1 - Actuellement ACTIF',
                mission: 'Captation des √©v√©nements terrain via formulaire rapide',
                actions: [
                    '<strong>Saisie via formulaire rapide</strong> (200 caract√®res max)',
                    '<strong>Sources :</strong>',
                    '‚Ä¢ Agents municipaux au Poste de Commandement',
                    '‚Ä¢ Remont√©es terrain (pompiers, police, services techniques)',
                    '‚Ä¢ √âlus et responsables de cellules',
                    '‚Ä¢ Partenaires externes (associations, entreprises)',
                    '<br><strong>Exemples d\'√©v√©nements :</strong>',
                    '‚Ä¢ "√âvacuation termin√©e Zone A"',
                    '‚Ä¢ "Route D940 coup√©e"',
                    '‚Ä¢ "Besoin renfort 5 agents"'
                ],
                highlight: '<strong>üìù Tra√ßabilit√© :</strong> Tous les √©v√©nements humains sont enregistr√©s dans la main-courante op√©rationnelle via ecrire_main_courante()',
                output: '√âv√©nements transmis √† l\'Agent 12 (Trieur) pour classification'
            },
            'decision-critique': {
                icon: 'üîÄ',
                title: 'Arbre de D√©cision Post-Classification',
                subtitle: 'Branchement automatique selon criticit√©',
                mission: 'Routage intelligent apr√®s classification par l\'Agent 12',
                actions: [
                    '<strong>Si PAS CRITIQUE (~95%) :</strong>',
                    '‚Üí Enregistrement dans main-courante op√©rationnelle',
                    '‚Üí Continue la veille automatique',
                    '‚Üí üîÑ Retour au d√©but de la boucle',
                    '<br><strong>Si CRITIQUE (~5%) :</strong>',
                    '‚Üí Activation imm√©diate de l\'Agent 13 (R√©√©valuateur)',
                    '‚Üí Analyse d\'impact approfondie',
                    '‚Üí Propositions de nouvelles d√©cisions',
                    '‚Üí Validation humaine requise'
                ],
                highlight: '‚ö° <strong>Principe :</strong> Seuls les √©v√©nements r√©ellement critiques (~5%) n√©cessitent une r√©√©valuation strat√©gique compl√®te. Les autres (~95%) sont simplement trac√©s.'
            }
        };

        function openModal(agentKey) {
            const data = agentsData[agentKey];
            if (!data) return;

            const modal = document.getElementById('modalOverlay');
            const content = document.getElementById('modalContent');
            
            let html = `
                <div class="modal-header">
                    <div class="modal-icon">${data.icon}</div>
                    <div>
                        <div class="modal-title">${data.title}</div>
                        ${data.subtitle ? `<div style="color: #6b7280; font-size: 14px; margin-top: 5px;">${data.subtitle}</div>` : ''}
                    </div>
                </div>
            `;

            if (data.model) {
                html += `<div style="text-align: center; margin-bottom: 20px;">
                    <span style="display: inline-block; padding: 8px 16px; background: #faf5ff; color: #8b5cf6; border: 2px solid #8b5cf6; border-radius: 20px; font-size: 12px; font-weight: 700;">${data.model}</span>
                </div>`;
            }

            if (data.mission) {
                html += `
                    <div class="modal-section">
                        <div class="modal-section-title">üéØ Mission :</div>
                        <div class="modal-content">${data.mission}</div>
                    </div>
                `;
            }

            if (data.highlight) {
                html += `<div class="modal-highlight">${data.highlight}</div>`;
            }

            if (data.actions) {
                html += `
                    <div class="modal-section">
                        <div class="modal-section-title">‚ö° Actions :</div>
                        <div class="modal-content">
                            <ul>
                                ${data.actions.map(action => `<li>${action}</li>`).join('')}
                            </ul>
                        </div>
                    </div>
                `;
            }

            if (data.functions) {
                html += `
                    <div class="modal-functions">
                        <div class="modal-section-title">üîß Functions disponibles :</div>
                        ${data.functions.map(fn => `<span class="modal-function-tag">${fn}</span>`).join('')}
                    </div>
                `;
            }

            if (data.output) {
                html += `
                    <div class="modal-section">
                        <div class="modal-section-title">üì§ Sortie :</div>
                        <div class="modal-content">${data.output}</div>
                    </div>
                `;
            }

            if (data.options) {
                html += `
                    <div class="modal-validation-options">
                        <div class="modal-section-title">‚ö° Options disponibles :</div>
                        ${data.options.map(opt => `<div class="modal-validation-option">${opt}</div>`).join('')}
                    </div>
                `;
            }

            content.innerHTML = html;
            modal.classList.add('active');
        }

        function closeModal() {
            document.getElementById('modalOverlay').classList.remove('active');
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Rendre tous les agents cliquables
            document.querySelectorAll('[data-agent]').forEach(item => {
                item.addEventListener('click', function() {
                    openModal(this.getAttribute('data-agent'));
                });
            });

            // Fermer si clic en dehors
            document.getElementById('modalOverlay').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeModal();
                }
            });

            // Fermer avec √âchap
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeModal();
                }
            });
        });
    </script>
</body>
</html>
